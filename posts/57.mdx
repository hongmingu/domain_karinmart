---
title: perl Moose 프레임워크 튜토리얼3 역할과 트레이트
description: 'Perl 객체 지향 프로그래밍을 위한 Moose 강의3 역할과 트레이트'
date: August 9 2023
---

지난 게시물에 이어 Moose에서의 역할과 트레이트에 대해 알아보자

## 역할

### 역할이란?

역할은 Moose에서 제공하는 코드의 재사용 메커니즘이다. 이것은 다른 객체 지향 언어에서 지칭되는 인터페이스나 믹스인(mixin)과 유사하다.

### 사용법

역할은 메소드와 속성을 포함할 수 있으나, 자체적으로 인스턴스화될 수는 없다.
클래스나 다른 역할에서 여러 역할을 소비할 수 있다. 소비된 역할의 메소드와 속성은 해당 클래스나 역할에 추가된다.

#### 코드 예시

```
package SpeakRole;
use Moose::Role;

sub speak {
    print "I can speak!\n";
}

package Human;
use Moose;
with 'SpeakRole';
```

여기서 Human 클래스는 SpeakRole 역할을 소비하므로 Human 객체는 speak 메서드를 호출할 수 있게 된다.

### 역할 상세히 알아보기

Moose의 역할은 코드 재사용성의 상승이다.
Perl의 전통적인 상속 메커니즘과는 달리 역할은 여러 클래스에서 공유될 수 있는 메서드와 속성의 패키지를 제공한다.

#### 속성과 메서드

역할 내에서 has 키워드를 사용해 속성을 정의할 수 있다.
메서드 또한 일반적으로 정의될 수 있다.

#### 인스턴스화 불가

역할은 인스턴스화될 수 없다. 즉 역할 자체로 객체를 생성할 수 없다. 대신 클래스에서 역할을 사용하여 해당 클래스의 인스턴스에 역할의 속성과 메서드를 부여한다.

#### 충돌

두 역할이 동일한 메서드를 제공하면 그 두 역할을 함께 소비하는 클래스는 충돌을 해결해야 한다. 이는 메서드 이름을 변경하거나 하나의 역할의 메서드를 우선시 하는 등의 방법으로 수행될 수 있다.

## 트레이트

### 트레이트란?

트레이트는 역할의 변형이다. 주로 객체나 클래스에 동적으로 역할을 적용할 때 사용된다. 이를 통해 코드의 유연성이 증가한다.

### 사용법

트레이트를 사용하면 실행 시간에 객체에 특정 역할을 부여하거나 변경할 수 있다.

#### 사용 예시

```
package LoudSpeakRole;
use Moose::Role;

around 'speak' => sub {
    my $orig = shift;
    my $self = shift;
    $self->$orig();
    print "I can speak LOUDLY!\n";
};

my $person = Human->new;
Moose::Util::apply_all_roles($person, 'LoudSpeakRole');
$person->speak;  # Outputs: I can speak! I can speak LOUDLY!
```

위 예제에서 LoudSpeakRole은 원래의 speak 메서드를 오버라이드하여 더 큰 소리로 말하는 행동을 추가한다.
apply_all_roles를 사용하여 LoudSpeakRole을 동적으로 $person 객체에 적용한다.

### 트레이트 심화

트레이트는 동적으로 역할을 객체나 클래스에 적용하는 메커니즘이다.

#### 동적 적용(런타임 적용)

트레이트를 사용하면, 프로그램 실행 중에 객체에 특정 역할을 부여하거나 변경할 수 있다. 이는 특히 유연성과 확장성이 필요한 경우에 유용한다.

#### 익명 역할

트레이트를 사용하여 임시적으로 정의된 역할(익명 역할)을 객체에 적용할 수 있다. 이를 통해 특정 객체에만 일시적인 행동을 부여할 수 있다.

#### 트레이트와 역할의 차이

주요 차이점은 적용 시점이다. 역할은 클래스 정의 시점에 적용되지만, 트레이트는 실행 시점에 객체에 적용된다.
예를 들면, Runnable이라는 역할이 있을 때, 특정 객체만 '빠르게' 달리게 만들고 싶다면 트레이트를 이용하여 해당 객체에만 '빠른 달리기'라는 행동을 동적으로 추가할 수 있다.

요약하면 Moose의 역할과 트레이트는 모두 다 코드 재사용과 유연성을 위한 것이다. Perl을 객체 지향 언어처럼 사용할 수 있게 해준다.
역할은 코드의 일부를 여러 클래스에서 공유하려는 경우에 트레이트는 런타임에 객체의 행동을 동적으로 변경하려는 경우에 사용된다.
